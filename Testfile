const blob = new Blob([byteStream], {
        type: fileExtension
          ? this.getMimeType(fileExtension)
          : "application/octet-stream"
      });

      // Trigger download
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = fileName;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      window.URL.revokeObjectURL(url);

      return { success: true };
    }


    return { success: false };

  } catch (error) {
    this.handleApiError(error);
    return { success: false };
  }
}

// Helper: map extensions to MIME types
private getMimeType(ext: string) {
  const map: Record<string, string> = {
    csv: "text/csv",
    xlsx: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
    xls: "application/vnd.ms-excel",
    pdf: "application/pdf",
    txt: "text/plain",
    json: "application/json"
  }
  
